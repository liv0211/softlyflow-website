<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />
  <title>治愈空间 - 你的心灵港湾</title>
  <meta
    name="description"
    content="一个温暖、自然的治愈空间，用于减压、正念和情感疗愈"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap"
    rel="stylesheet"
  />
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
      background: linear-gradient(135deg, #fef5e7 0%, #f4e4c1 50%, #e8d5b7 100%);
      min-height:100vh; color:#2d3748; line-height:1.6;
    }
    .container { max-width:1200px; margin:0 auto; padding:20px; }
    .header { text-align:center; margin-bottom:28px; color:#fff; }
    .header h1 { font-size:2.4rem; font-weight:300; margin-bottom:8px; text-shadow:0 2px 4px rgba(0,0,0,.08); }
    .header p { font-size:1.06rem; opacity:.95; }

    /* Language selector */
    .language-selector { position:relative; display:inline-block; margin-top:12px; }
    .language-btn {
      background: linear-gradient(135deg, rgba(255,255,255,.95), rgba(255,255,255,.85));
      border: 1px solid rgba(210, 105, 30, 0.3);
      color: #8B4513;
      padding: 10px 18px; 
      border-radius: 25px; 
      cursor: pointer;
      backdrop-filter: blur(10px); 
      transition: all 0.3s ease; 
      display: flex; 
      align-items: center; 
      gap: 10px;
      font-weight: 500;
    }
    .language-btn:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 8px 20px rgba(139, 69, 19, 0.15);
      border-color: rgba(210, 105, 30, 0.5);
    }
    .language-dropdown {
      position:absolute; top:115%; left:0; background:rgba(255,255,255,.98); border-radius:16px;
      box-shadow:0 15px 35px rgba(139, 69, 19, 0.15); padding:12px 0; min-width:180px; display:none; z-index:1000;
      border: 1px solid rgba(210, 105, 30, 0.2);
      backdrop-filter: blur(15px);
    }
    .language-dropdown.show { display:block; }
    .language-option { 
      padding:12px 18px; 
      cursor:pointer; 
      transition: all 0.3s ease; 
      display:flex; 
      align-items:center; 
      gap:10px; 
      color:#8B4513;
      border-radius: 8px;
      margin: 0 8px;
    }
    .language-option:hover { 
      background:rgba(210, 105, 30, 0.1); 
      transform: translateX(4px);
    }
    .language-option.active { 
      background:rgba(210, 105, 30, 0.15); 
      font-weight:600;
      border-left: 3px solid #D2691E;
    }
    .flag { width:20px; height:14px; background-size:cover; border-radius:2px; border:1px solid rgba(0,0,0,.08); }
    /* 正确国旗（简化矢量） */
    .flag-cn { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="42" viewBox="0 0 30 21"><rect width="30" height="21" fill="%23DE2910"/><g fill="%23FFDE00"><polygon points="4,2 5,5 8,5 6,7 7,10 4,8 1,10 2,7 0,5 3,5"/><polygon transform="translate(9 1) rotate(23 0 0)" points="0,0 0.8,2.4 3.2,2.4 1.2,3.9 2,6.3 0,4.8 -2,6.3 -1.2,3.9 -3.2,2.4 -0.8,2.4"/></g></svg>'); }
    .flag-tw { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="42" viewBox="0 0 30 21"><rect width="30" height="21" fill="%23FE0000"/><rect width="12" height="8" fill="%23003E87"/><circle cx="6" cy="4" r="2.2" fill="%23fff"/><g fill="%23fff" transform="translate(6 4)"><g transform="rotate(15)"><rect x="-0.6" y="-3.8" width="1.2" height="7.6"/></g><g transform="rotate(45)"><rect x="-0.6" y="-3.8" width="1.2" height="7.6"/></g><g transform="rotate(75)"><rect x="-0.6" y="-3.8" width="1.2" height="7.6"/></g></g></svg>'); }
    .flag-en { /* 使用美国旗作为英文 */
      background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="76" height="40" viewBox="0 0 38 20"><rect width="38" height="20" fill="%23B22234"/><g fill="%23fff"><rect y="2" width="38" height="2"/><rect y="6" width="38" height="2"/><rect y="10" width="38" height="2"/><rect y="14" width="38" height="2"/><rect y="18" width="38" height="2"/></g><rect width="15" height="10.5" fill="%233C3B6E"/><g fill="%23fff" transform="scale(.9) translate(1,1)"><circle r=".4" cx="2" cy="2"/><circle r=".4" cx="4" cy="2"/><circle r=".4" cx="6" cy="2"/><circle r=".4" cx="8" cy="2"/><circle r=".4" cx="10" cy="2"/><circle r=".4" cx="3" cy="3"/><circle r=".4" cx="5" cy="3"/><circle r=".4" cx="7" cy="3"/><circle r=".4" cx="9" cy="3"/><circle r=".4" cx="2" cy="4"/><circle r=".4" cx="4" cy="4"/><circle r=".4" cx="6" cy="4"/><circle r=".4" cx="8" cy="4"/></g></svg>');
    }
    .flag-kr { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="42" viewBox="0 0 30 21"><rect width="30" height="21" fill="%23fff"/><circle cx="15" cy="10.5" r="5" fill="%23CD2E3A"/><path d="M15 5.5a5 5 0 0 1 0 10a5 5 0 0 0 0-10" fill="%23004A9C"/><g stroke="%23000000" stroke-width="1.2"><g transform="translate(5,4) rotate(-30 0 0)"><line x1="-2" y1="-1.6" x2="2" y2="-1.6"/><line x1="-2" y1="0" x2="2" y2="0"/><line x1="-2" y1="1.6" x2="2" y2="1.6"/></g><g transform="translate(25,4) rotate(30 0 0)"><line x1="-2" y1="-1.6" x2="2" y2="-1.6"/><line x1="-2" y1="1.6" x2="2" y2="1.6"/></g><g transform="translate(5,17) rotate(30 0 0)"><line x1="-2" y1="-1.6" x2="2" y2="-1.6"/><line x1="-2" y1="1.6" x2="2" y2="1.6"/></g><g transform="translate(25,17) rotate(-30 0 0)"><line x1="-2" y1="-1.6" x2="2" y2="-1.6"/><line x1="-2" y1="0" x2="2" y2="0"/><line x1="-2" y1="1.6" x2="2" y2="1.6"/></g></g></svg>'); }
    .flag-jp { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="42" viewBox="0 0 30 21"><rect width="30" height="21" fill="%23FFFFFF"/><circle cx="15" cy="10.5" r="5.5" fill="%23BC002D"/></svg>'); }

    .nav { display:flex; justify-content:center; flex-wrap:wrap; gap:12px; margin:10px 0 26px; }
    .nav-btn {
      background:rgba(255,255,255,.96); border:none; padding:11px 20px; border-radius:24px; cursor:pointer;
      font-size:.98rem; font-weight:500; transition:all .25s ease; box-shadow:0 4px 15px rgba(0,0,0,.08);
    }
    .nav-btn:hover { transform:translateY(-1px); box-shadow:0 6px 18px rgba(0,0,0,.12); }
    .nav-btn.active { background:#667eea; color:#fff; }

    .section {
      display:none; 
      background: linear-gradient(135deg, rgba(255,255,255,.95), rgba(255,255,255,.88));
      border-radius: 24px; 
      padding: 32px; 
      margin-bottom: 28px;
      box-shadow: 0 15px 35px rgba(139, 69, 19, 0.08); 
      backdrop-filter: blur(12px); 
      animation: fadeIn .6s ease;
      border: 1px solid rgba(255, 255, 255, 0.3);
      position: relative;
      overflow: hidden;
    }
    .section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #D2691E, #CD853F, #DEB887);
      opacity: 0.8;
    }
    .section.active { display:block; }
    @keyframes fadeIn { 
      from{opacity:0; transform:translateY(20px);} 
      to{opacity:1; transform:translateY(0);} 
    }

    .quote-container { text-align:center; max-width:820px; margin:0 auto; }
    .quote { 
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem; 
      font-weight: 400; 
      margin-bottom: 24px; 
      line-height: 1.6; 
      color: #8B4513; 
      transition: all 0.4s ease;
      text-shadow: 0 1px 3px rgba(139, 69, 19, 0.1);
    }
    .new-quote-btn {
      background: linear-gradient(135deg, #D2691E 0%, #CD853F 100%); 
      color: #fff; 
      border: none; 
      padding: 16px 28px; 
      border-radius: 28px;
      font-size: 1.1rem; 
      font-weight: 500;
      cursor: pointer; 
      transition: all 0.3s ease; 
      box-shadow: 0 8px 20px rgba(210, 105, 30, 0.3);
    }
    .new-quote-btn:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 12px 25px rgba(210, 105, 30, 0.4);
    }

    /* 语录互动功能样式 */
    .quote-actions {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-bottom: 20px;
    }
    .quote-action-btn {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(210, 105, 30, 0.3);
      border-radius: 20px;
      padding: 8px 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
      color: #8B4513;
    }
    .quote-action-btn:hover {
      background: rgba(255, 255, 255, 0.95);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(210, 105, 30, 0.2);
    }
    .like-btn.liked {
      background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
      color: white;
      border-color: #FF6B6B;
    }
    .favorite-btn.favorited {
      background: linear-gradient(135deg, #FFD93D 0%, #FFB84D 100%);
      color: white;
      border-color: #FFD93D;
    }
    .quote-comments {
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      border: 1px solid rgba(210, 105, 30, 0.2);
      backdrop-filter: blur(10px);
    }
    .comments-list {
      margin-bottom: 20px;
      max-height: 300px;
      overflow-y: auto;
    }
    .comment-item {
      padding: 12px;
      margin-bottom: 12px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
      border-left: 4px solid #D2691E;
    }
    .comment-text {
      color: #8B4513;
      margin-bottom: 8px;
      line-height: 1.5;
    }
    .comment-meta {
      font-size: 0.8rem;
      color: #A0522D;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .comment-input textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid rgba(210, 105, 30, 0.3);
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.9rem;
      resize: vertical;
      background: rgba(255, 255, 255, 0.8);
      color: #8B4513;
    }
    .comment-input textarea:focus {
      outline: none;
      border-color: #D2691E;
      box-shadow: 0 0 0 3px rgba(210, 105, 30, 0.1);
    }
    .comment-submit-btn {
      background: linear-gradient(135deg, #D2691E 0%, #CD853F 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      margin-top: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .comment-submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(210, 105, 30, 0.3);
    }

    .mystic-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(280px,1fr)); gap:20px; margin-top:16px; }
    .mystic-card { 
      background: linear-gradient(135deg, #DEB887 0%, #D2B48C 100%); 
      color: #8B4513; 
      padding: 28px; 
      border-radius: 20px; 
      text-align:center; 
      box-shadow: 0 12px 30px rgba(139, 69, 19, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.3);
      position: relative;
      overflow: hidden;
    }
    .mystic-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="mystic" width="50" height="50" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="2" fill="%23ffffff" opacity="0.1"/><circle cx="10" cy="10" r="1" fill="%23ffffff" opacity="0.15"/><circle cx="40" cy="40" r="1" fill="%23ffffff" opacity="0.15"/></pattern></defs><rect width="100" height="100" fill="url(%23mystic)"/></svg>');
      opacity: 0.6;
    }
    .mystic-card h3 { 
      margin-bottom: 16px; 
      font-size: 1.4rem;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      position: relative;
      z-index: 1;
    }
    .mystic-btn { 
      background: rgba(255,255,255,.25); 
      color: #8B4513; 
      border: 1px solid rgba(255,255,255,.4); 
      padding: 12px 20px; 
      border-radius: 25px; 
      cursor: pointer; 
      transition: all 0.3s ease;
      font-weight: 500;
      position: relative;
      z-index: 1;
    }
    .mystic-btn:hover { 
      background: rgba(255,255,255,.4);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(139, 69, 19, 0.2);
    }
    .mystic-result { 
      margin-top: 16px; 
      padding: 16px; 
      background: rgba(255,255,255,.3); 
      border-radius: 12px; 
      transition: all 0.4s ease; 
      text-align: left; 
      font-size: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      z-index: 1;
    }

    .games-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(300px,1fr)); gap:24px; margin-top:16px; }
    .game-container { 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      padding: 24px; 
      border-radius: 18px; 
      border: 1px solid rgba(210, 105, 30, 0.2);
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.08);
      backdrop-filter: blur(10px);
    }
    .game-container h3 {
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      margin-bottom: 12px;
    }
    .bubble-game { 
      width:100%; 
      height:280px; 
      background: linear-gradient(180deg, #F5DEB3 0%, #DEB887 100%); 
      border-radius: 16px; 
      position:relative; 
      overflow:hidden; 
      cursor:pointer;
      border: 2px solid rgba(210, 105, 30, 0.3);
    }
    .bubble { 
      position:absolute; 
      background: radial-gradient(circle, rgba(210,105,30,.8) 0%, rgba(205,133,63,.6) 100%); 
      border-radius:50%; 
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(139, 69, 19, 0.3);
    }
    .bubble:hover { 
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(139, 69, 19, 0.4);
    }
    canvas.sand-canvas { 
      width:100%; 
      height:280px; 
      background: #F5DEB3; 
      border-radius: 16px; 
      border: 2px solid rgba(210, 105, 30, 0.3);
      touch-action: none;
    }

    .mood-quiz { max-width:640px; margin:0 auto; }
    .mood-quiz h3 {
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      margin-bottom: 20px;
      text-align: center;
    }
    .mood-options { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:16px; margin:20px 0; }
    .mood-option { 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border: 2px solid rgba(210, 105, 30, 0.3); 
      border-radius: 16px; 
      padding: 16px; 
      text-align:center; 
      cursor:pointer; 
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    .mood-option:hover { 
      border-color: #D2691E; 
      background: rgba(210, 105, 30, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(139, 69, 19, 0.15);
    }
    .mood-option input { margin-right:8px; }
    .mood-check-btn { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color: #fff; 
      border: none; 
      padding: 14px 24px; 
      border-radius: 25px; 
      cursor: pointer; 
      transition: all 0.3s ease; 
      margin-top: 12px;
      font-weight: 500;
      font-size: 1.1rem;
    }
    .mood-check-btn:hover { 
      background: linear-gradient(135deg, #CD853F, #D2691E);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(210, 105, 30, 0.3);
    }
    .mood-result { 
      margin-top: 16px; 
      padding: 18px; 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border: 1px solid rgba(210, 105, 30, 0.3); 
      border-radius: 16px; 
      display: none;
      text-align: center;
      font-size: 1.1rem;
      color: #8B4513;
      backdrop-filter: blur(10px);
    }

    .breathing-container { text-align:center; max-width:600px; margin:0 auto; }
    .breathing-container h2 {
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      margin-bottom: 24px;
    }
    .breathing-instructions { 
      margin-bottom: 16px; 
      font-size: 1.1rem; 
      color: #A0522D;
      font-weight: 500;
    }
    .breathing-animation { 
      width: 280px; 
      height: 280px; 
      border: 6px solid #D2691E; 
      border-radius: 50%; 
      margin: 24px auto; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      animation: breatheCycle 19s infinite ease-in-out;
      background: linear-gradient(135deg, rgba(255,255,255,.1), rgba(255,255,255,.05));
      box-shadow: 0 15px 35px rgba(139, 69, 19, 0.2);
      position: relative;
      overflow: hidden;
    }
    .breathing-animation::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="breath" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="%23ffffff" opacity="0.2"/><circle cx="80" cy="80" r="1" fill="%23ffffff" opacity="0.2"/><circle cx="50" cy="50" r="0.5" fill="%23ffffff" opacity="0.3"/></pattern></defs><rect width="100" height="100" fill="url(%23breath)"/></svg>');
      opacity: 0.4;
    }
    @keyframes breatheCycle { 
      0%,100%{transform:scale(1)} 
      12.5%{transform:scale(1.3)} 
      37.5%{transform:scale(1.3)} 
      62.5%{transform:scale(.8)} 
      87.5%{transform:scale(.8)} 
    }
    .breathing-step { 
      font-size: 1.4rem; 
      color: #8B4513; 
      font-weight: 600;
      position: relative;
      z-index: 1;
    }

    .journal-container { max-width:860px; margin:0 auto; }
    .journal-container h2 {
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      margin-bottom: 24px;
      text-align: center;
    }
    .journal-textarea { 
      width:100%; 
      height:200px; 
      padding:20px; 
      border: 2px solid rgba(210, 105, 30, 0.3); 
      border-radius: 18px; 
      font-size: 1rem; 
      resize: vertical; 
      margin: 12px 0 16px;
      background: rgba(255,255,255,.9);
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
    }
    .journal-textarea:focus {
      outline: none;
      border-color: #D2691E;
      box-shadow: 0 0 0 3px rgba(210, 105, 30, 0.1);
    }
    .journal-controls { display:flex; gap:12px; flex-wrap:wrap; margin-bottom:16px; justify-content: center; }
    .journal-btn { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color: #fff; 
      border: none; 
      padding: 12px 20px; 
      border-radius: 20px; 
      cursor: pointer; 
      transition: all 0.3s ease;
      font-weight: 500;
    }
    .journal-btn:hover { 
      background: linear-gradient(135deg, #CD853F, #D2691E);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(210, 105, 30, 0.3);
    }
    .journal-entries { 
      display: none; 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border: 1px solid rgba(210, 105, 30, 0.2); 
      border-radius: 18px; 
      padding: 20px;
      backdrop-filter: blur(10px);
    }
    .journal-entry { 
      padding: 16px 0; 
      border-bottom: 1px solid rgba(210, 105, 30, 0.2);
      margin-bottom: 12px;
    }
    .journal-entry:last-child { border-bottom: none; margin-bottom: 0; }
    .entry-date { 
      font-weight: 600; 
      color: #D2691E; 
      margin-bottom: 8px;
      font-size: 1.1rem;
    }
    .entry-text {
      color: #8B4513;
      line-height: 1.6;
    }

    .sounds-container { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:20px; margin-top:16px; }
    .sound-item { 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      padding: 24px; 
      border-radius: 18px; 
      border: 1px solid rgba(210, 105, 30, 0.2);
      text-align: center;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.08);
    }
    .sound-item h3 {
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      margin-bottom: 16px;
    }
    .sound-toggle { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color: #fff; 
      border: none; 
      padding: 12px 20px; 
      border-radius: 20px; 
      cursor: pointer; 
      margin-bottom: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .sound-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(210, 105, 30, 0.3);
    }
    .sound-toggle.playing { 
      background: linear-gradient(135deg, #CD853F, #D2691E);
    }
    .volume-slider { 
      width: 100%;
      accent-color: #D2691E;
    }

    /* Blog */
    .blog-list { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin-top:16px; }
    .post-card { 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border: 1px solid rgba(210, 105, 30, 0.2); 
      border-radius: 18px; 
      padding: 24px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.08);
      transition: all 0.3s ease;
    }
    .post-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(139, 69, 19, 0.12);
    }
    .post-title { 
      font-size: 1.2rem; 
      font-weight: 600; 
      color: #8B4513; 
      margin-bottom: 8px;
      font-family: 'Playfair Display', serif;
    }
    .post-meta { 
      font-size: 0.9rem; 
      color: #A0522D; 
      margin-bottom: 12px;
      font-weight: 500;
    }
    .post-tags { display:flex; flex-wrap:wrap; gap:8px; margin:12px 0; }
    .tag { 
      background: rgba(210, 105, 30, 0.1); 
      color: #8B4513; 
      border-radius: 12px; 
      padding: 4px 12px; 
      font-size: 0.85rem;
      border: 1px solid rgba(210, 105, 30, 0.2);
    }
    .post-actions { display:flex; gap:12px; margin-top:16px; }
    .btn-link { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color: #fff; 
      border: none; 
      padding: 10px 16px; 
      border-radius: 16px; 
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .btn-link:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(210, 105, 30, 0.3);
    }
    .post-content { 
      margin-top: 16px; 
      color: #8B4513; 
      display: none; 
      white-space: pre-wrap;
      line-height: 1.6;
      padding: 16px;
      background: rgba(255,255,255,.5);
      border-radius: 12px;
      border: 1px solid rgba(210, 105, 30, 0.1);
    }

    .footer { 
      text-align: center; 
      margin-top: 32px; 
      padding: 24px; 
      color: rgba(139, 69, 19, 0.8); 
      font-size: 1rem;
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border-radius: 20px;
      border: 1px solid rgba(210, 105, 30, 0.2);
      backdrop-filter: blur(10px);
    }

    @media (max-width:768px){
      .hero-title{font-size:2.2rem}
      .section{padding:20px}
      .breathing-animation{width:220px;height:220px}
      .quote{font-size:1.5rem}
      .topbar{padding:12px 16px}
      .logo{font-size:1.3rem}
    }
    .topbar {
      position: sticky; top: 0; z-index: 100;
      display: flex; justify-content: space-between; align-items: center;
      background: rgba(255,255,255,.95); backdrop-filter: blur(15px);
      border-radius: 20px; padding: 16px 24px; margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(139, 69, 19, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    .logo { 
      font-family: 'Playfair Display', serif;
      font-weight: 600; 
      font-size: 1.5rem;
      letter-spacing:.3px; 
      color:#8B4513;
      background: linear-gradient(135deg, #D2691E, #CD853F);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .nav-links { display:flex; align-items:center; gap:10px; }
    .nav-links .nav-btn { 
      background: transparent; 
      box-shadow: none; 
      border-radius: 18px; 
      padding: 10px 16px; 
      color: #8B4513;
      font-weight: 500;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }
    .nav-links .nav-btn:hover {
      background: rgba(210, 105, 30, 0.1);
      border-color: rgba(210, 105, 30, 0.3);
    }
    .nav-links .nav-btn.active { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color: #fff; 
      box-shadow: 0 4px 15px rgba(210, 105, 30, 0.3);
    }

    .hero {
      background: linear-gradient(135deg, rgba(255,255,255,.92), rgba(255,255,255,.78));
      border-radius: 24px; text-align:center; padding: 80px 32px; 
      box-shadow:0 20px 40px rgba(139, 69, 19, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.4);
      position: relative;
      overflow: hidden;
    }
    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="%23f4e4c1" opacity="0.3"/><circle cx="75" cy="75" r="1" fill="%23e8d5b7" opacity="0.3"/><circle cx="50" cy="10" r="0.5" fill="%23d2691e" opacity="0.2"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
      opacity: 0.6;
    }
    .hero-title { 
      font-family: 'Playfair Display', serif;
      font-size: 3rem; 
      font-weight: 600; 
      color:#8B4513;
      margin-bottom: 16px;
      text-shadow: 0 2px 4px rgba(139, 69, 19, 0.1);
      position: relative;
      z-index: 1;
    }
    .hero-subtitle { 
      margin-top:16px; 
      color:#A0522D; 
      font-size: 1.2rem;
      position: relative;
      z-index: 1;
    }
    .hero-ctas { margin-top:32px; display:flex; gap:16px; justify-content:center; position: relative; z-index: 1; }
    .cta-btn { 
      background: linear-gradient(135deg, #D2691E, #CD853F); 
      color:#fff; 
      border:none; 
      padding:16px 28px; 
      border-radius:25px; 
      cursor:pointer;
      font-weight: 500;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 8px 20px rgba(210, 105, 30, 0.3);
    }
    .cta-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 25px rgba(210, 105, 30, 0.4);
    }
    .cta-btn.ghost { 
      background:transparent; 
      color:#8B4513; 
      border:2px solid #D2691E;
      box-shadow: none;
    }
    .cta-btn.ghost:hover {
      background: rgba(210, 105, 30, 0.1);
    }

    .feature-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px; margin-top:14px; }
    .feature-card {
      background: linear-gradient(135deg, rgba(255,255,255,.95), rgba(255,255,255,.85));
      border: 1px solid rgba(210, 105, 30, 0.2); 
      border-radius: 20px; 
      padding: 24px; 
      cursor:pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #D2691E, #CD853F, #DEB887);
    }
    .feature-card:hover { 
      transform: translateY(-4px); 
      box-shadow: 0 20px 40px rgba(139, 69, 19, 0.15);
      border-color: rgba(210, 105, 30, 0.4);
    }
    .fc-title { 
      font-family: 'Playfair Display', serif;
      font-weight: 600; 
      color: #8B4513; 
      font-size: 1.2rem;
      margin-bottom: 8px;
    }
    .fc-desc { 
      color: #A0522D; 
      font-size: 1rem; 
      margin-top: 8px;
      line-height: 1.5;
    }

    .about-cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:16px; margin-top:16px; }
    .about-card { 
      background: linear-gradient(135deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
      border: 1px solid rgba(210, 105, 30, 0.2); 
      border-radius: 18px; 
      padding: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(139, 69, 19, 0.08);
      transition: all 0.3s ease;
    }
    .about-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(139, 69, 19, 0.12);
    }
    .ac-title { 
      font-weight: 600; 
      color: #8B4513;
      font-family: 'Playfair Display', serif;
      font-size: 1.2rem;
      margin-bottom: 8px;
    }
    .ac-desc { 
      color: #A0522D; 
      margin-top: 8px;
      line-height: 1.6;
    }

    .policy-list { 
      margin-top: 16px; 
      padding-left: 20px; 
      color: #A0522D;
      line-height: 1.6;
    }
    .policy-list li {
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 顶部极简导航 -->
    <div class="topbar">
      <div class="logo">治愈空间</div>
      <div class="nav-links">
        <button class="nav-btn active" data-section="home" data-translate="navHome">首页</button>
        <button class="nav-btn" data-section="features" data-translate="navFeatures">功能</button>
        <button class="nav-btn" data-section="blog" data-translate="navBlog">治愈博客</button>
        <button class="nav-btn" data-section="about" data-translate="navAbout">关于我们</button>
        <button class="nav-btn" data-section="privacy" data-translate="navPrivacy">隐私政策</button>
        <div class="language-selector">
          <button class="language-btn" id="languageBtn">
            <span class="flag flag-cn"></span>
            <span data-translate="currentLang">简体中文</span>
          </button>
          <div class="language-dropdown" id="languageDropdown">
            <div class="language-option active" data-lang="zh-CN"><span class="flag flag-cn"></span>简体中文</div>
            <div class="language-option" data-lang="zh-TW"><span class="flag flag-tw"></span>繁體中文</div>
            <div class="language-option" data-lang="en"><span class="flag flag-en"></span>English</div>
            <div class="language-option" data-lang="ko"><span class="flag flag-kr"></span>한국어</div>
            <div class="language-option" data-lang="ja"><span class="flag flag-jp"></span>日本語</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 英雄区（极简大气） -->
    <div class="hero section active" id="home">
      <h1 class="hero-title" data-translate="heroTitle">温暖治愈，心灵港湾</h1>
      <p class="hero-subtitle" data-translate="heroSubtitle">在这里，让疲惫的心灵找到归属，让温暖的自然力量治愈你的每一天。</p>
      <div class="hero-ctas">
        <button class="cta-btn" data-go="quote" data-translate="ctaStart">开始治愈之旅</button>
        <button class="cta-btn ghost" data-go="features" data-translate="ctaExplore">探索治愈功能</button>
      </div>
    </div>

    <!-- 功能总览（卡片跳转到原有功能区） -->
    <div class="section" id="features">
      <h2 data-translate="navFeatures">功能</h2>
      <div class="feature-grid">
        <div class="feature-card" data-go="quote"><div class="fc-title" data-translate="fQuote">每日治愈语录</div><div class="fc-desc" data-translate="fQuoteDesc">温暖人心的智慧话语，点亮每一天</div></div>
        <div class="feature-card" data-go="breathing"><div class="fc-title" data-translate="fBreath">呼吸疗愈</div><div class="fc-desc" data-translate="fBreathDesc">4-7-8 呼吸法，让身心回归平静</div></div>
        <div class="feature-card" data-go="mystic"><div class="fc-title" data-translate="fMystic">心灵探索</div><div class="fc-desc" data-translate="fMysticDesc">塔罗/星座/幸运饼干，发现内心的答案</div></div>
        <div class="feature-card" data-go="games"><div class="fc-title" data-translate="fGames">放松游戏</div><div class="fc-desc" data-translate="fGamesDesc">泡泡/沙画，在游戏中释放压力</div></div>
        <div class="feature-card" data-go="journal"><div class="fc-title" data-translate="fJournal">心灵日记</div><div class="fc-desc" data-translate="fJournalDesc">记录内心感受，见证成长轨迹</div></div>
        <div class="feature-card" data-go="sounds"><div class="fc-title" data-translate="fSounds">自然疗愈</div><div class="fc-desc" data-translate="fSoundsDesc">雨声/海浪/鸟鸣，大自然的治愈力量</div></div>
      </div>
    </div>

    <!-- Quote -->
    <div id="quote" class="section">
      <div class="quote-container">
        <div class="quote" id="quoteText">每一个今天都是昨天死去的人期待的明天。</div>
        <div class="quote-actions">
          <button class="quote-action-btn like-btn" id="likeBtn" data-translate="likeQuote" title="点赞" onclick="toggleLike()">
            <span class="like-icon">❤️</span>
            <span class="like-count" id="likeCount">0</span>
          </button>
          <button class="quote-action-btn favorite-btn" id="favoriteBtn" data-translate="favoriteQuote" title="收藏" onclick="toggleFavorite()">
            <span class="favorite-icon">⭐</span>
          </button>
          <button class="quote-action-btn comment-btn" id="commentBtn" data-translate="commentQuote" title="评论" onclick="toggleComments()">
            <span class="comment-icon">💬</span>
          </button>
        </div>
        <div class="quote-comments" id="quoteComments" style="display: none;">
          <div class="comments-list" id="commentsList"></div>
          <div class="comment-input">
                      <textarea id="commentText" data-translate-placeholder="commentPlaceholder" placeholder="写下你的感受..." rows="3"></textarea>
                      <button id="submitComment" class="comment-submit-btn" data-translate="submitComment" onclick="addComment()">发表评论</button>
          </div>
        </div>
        <button class="new-quote-btn" id="newQuoteBtn" data-translate="newQuote">新语录</button>
      </div>
    </div>

    <!-- Mystic -->
    <div id="mystic" class="section">
      <h2 data-translate="navMystic">心灵探索</h2>
      <div class="mystic-grid">
        <div class="mystic-card">
          <h3 data-translate="tarotTitle">塔罗牌</h3>
          <button class="mystic-btn" id="tarotBtn" data-translate="drawCard">抽牌</button>
          <div class="mystic-result" id="tarotResult" style="display:none;"></div>
        </div>
        <div class="mystic-card">
          <h3>幸运饼干</h3>
          <button class="mystic-btn" id="fortuneBtn">点击打开</button>
          <div class="mystic-result" id="fortuneResult" style="display:none;"></div>
          <div class="mystic-result" id="fortuneHistory" style="display:none;"></div>
        </div>
        <div class="mystic-card">
          <h3>每日星座</h3>
          <select id="zodiacSelect" style="padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.55);margin:6px 0;">
            <option value="aries">白羊座</option><option value="taurus">金牛座</option>
            <option value="gemini">双子座</option><option value="cancer">巨蟹座</option>
            <option value="leo">狮子座</option><option value="virgo">处女座</option>
            <option value="libra">天秤座</option><option value="scorpio">天蝎座</option>
            <option value="sagittarius">射手座</option><option value="capricorn">摩羯座</option>
            <option value="aquarius">水瓶座</option><option value="pisces">双鱼座</option>
          </select>
          <button class="mystic-btn" id="astrologyBtn">查看运势</button>
          <div class="mystic-result" id="astrologyResult" style="display:none;"></div>
        </div>
      </div>
    </div>

    <!-- Games -->
    <div id="games" class="section">
      <h2 data-translate="navGames">放松游戏</h2>
      <div class="games-grid">
        <div class="game-container">
          <h3 data-translate="gameBubble">泡泡游戏</h3>
          <p data-translate="bubbleInstructions">点击泡泡来消除它们</p>
          <div class="bubble-game"></div>
          <p><span data-translate="scoreText">得分: </span><span id="bubbleScore">0</span></p>
        </div>
        <div class="game-container">
          <h3 data-translate="gameSand">沙画板</h3>
          <p data-translate="sandInstructions">在画布上绘制你的想法</p>
          <canvas class="sand-canvas"></canvas>
        </div>
      </div>
    </div>

    <!-- Psychology -->
    <div id="psychology" class="section">
      <h2 data-translate="navPsychology">心灵角落</h2>
      <div class="mood-quiz">
        <h3 data-translate="moodQuestion">今天的心灵感受如何？</h3>
        <div class="mood-options">
          <label class="mood-option"><input type="radio" name="mood" value="happy"><span data-translate="moodHappy">开心 😊</span></label>
          <label class="mood-option"><input type="radio" name="mood" value="calm"><span data-translate="moodCalm">平静 😌</span></label>
          <label class="mood-option"><input type="radio" name="mood" value="anxious"><span data-translate="moodAnxious">焦虑 😰</span></label>
          <label class="mood-option"><input type="radio" name="mood" value="sad"><span data-translate="moodSad">难过 😢</span></label>
          <label class="mood-option"><input type="radio" name="mood" value="tired"><span data-translate="moodTired">疲惫 😴</span></label>
        </div>
        <button class="mood-check-btn" data-translate="moodCheck">检查心情</button>
        <div class="mood-result"></div>
      </div>
    </div>

    <!-- Breathing -->
    <div id="breathing" class="section">
      <div class="breathing-container">
        <h2 data-translate="navBreathing">呼吸疗愈</h2>
        <div class="breathing-instructions"><p data-translate="breathingInstructions">跟随圆圈进行4-7-8呼吸疗愈，让身心回归平静</p></div>
        <div class="breathing-animation"><div class="breathing-step" id="breathingText" data-translate="breathingInhale">吸气 (4秒)</div></div>
      </div>
    </div>

    <!-- Journal -->
    <div id="journal" class="section">
      <div class="journal-container">
        <h2 data-translate="navJournal">心灵日记</h2>
        <textarea class="journal-textarea" data-translate-placeholder="journalPlaceholder" placeholder="写下你今天的内心感受，让文字成为心灵的镜子..."></textarea>
        <div class="journal-controls">
                  <button class="journal-btn" data-translate="saveJournal">保存心灵记录</button>
        <button class="journal-btn" data-translate="viewJournal">查看成长轨迹</button>
        <button class="journal-btn" data-translate="clearJournal">清空记录</button>
        </div>
        <div class="journal-entries"></div>
      </div>
    </div>

    <!-- Sounds -->
    <div id="sounds" class="section">
      <h2 data-translate="navSounds">自然疗愈</h2>
      <div class="sounds-container">
        <div class="sound-item">
          <h3 data-translate="soundRain">雨声</h3>
          <button class="sound-toggle" data-sound="rain" data-translate="playSound">播放</button>
          <input type="range" class="volume-slider" data-sound="rain" min="0" max="100" value="50">
        </div>
        <div class="sound-item">
          <h3 data-translate="soundOcean">海浪声</h3>
          <button class="sound-toggle" data-sound="ocean" data-translate="playSound">播放</button>
          <input type="range" class="volume-slider" data-sound="ocean" min="0" max="100" value="50">
        </div>
        <div class="sound-item">
          <h3 data-translate="soundForest">森林鸟鸣</h3>
          <button class="sound-toggle" data-sound="forest" data-translate="playSound">播放</button>
          <input type="range" class="volume-slider" data-sound="forest" min="0" max="100" value="50">
        </div>
      </div>
    </div>

    <!-- Blog -->
    <div id="blog" class="section">
      <h2 data-translate="navBlog">治愈博客</h2>
      <div class="blog-list" id="blogList"></div>
    </div>

    <!-- About Us -->
    <div id="about" class="section">
      <h2 data-translate="navAbout">关于我们</h2>
      <p data-translate="aboutP1">治愈空间致力于以温暖自然的设计与科学方法，为疲惫的心灵提供温暖、可持续的自我疗愈空间。</p>
      <p data-translate="aboutP2">我们相信：真正的治愈来自内心的平静与自然的温暖。在这里，让每一次呼吸都成为治愈的开始。</p>
      <div class="about-cards">
        <div class="about-card"><div class="ac-title" data-translate="aboutValue1">温暖与科学</div><div class="ac-desc" data-translate="aboutValue1D">结合心理学与自然疗法，以温暖的感官体验实现心灵治愈。</div></div>
        <div class="about-card"><div class="ac-title" data-translate="aboutValue2">自然与可达</div><div class="ac-desc" data-translate="aboutValue2D">跨设备无障碍，低认知负担，随时找到心灵的港湾。</div></div>
        <div class="about-card"><div class="ac-title" data-translate="aboutValue3">隐私与信任</div><div class="ac-desc" data-translate="aboutValue3D">数据仅存本地，无账号、无追踪，保护你的内心世界。</div></div>
      </div>
    </div>

    <!-- Privacy Policy -->
    <div id="privacy" class="section">
      <h2 data-translate="navPrivacy">隐私政策</h2>
      <p data-translate="privacyIntro">我们尊重并保护你的隐私。除非你手动导出，否则数据仅存储在你的设备本地。</p>
      <ul class="policy-list">
        <li data-translate="privacyLocal">本地存储：日记与偏好通过浏览器 localStorage 保存在你的设备上。</li>
        <li data-translate="privacyNoCollect">不收集：我们不采集可识别个人信息。</li>
        <li data-translate="privacyThird">第三方：如后续接入第三方音频/分析服务，将在此更新并提供选择退出。</li>
        <li data-translate="privacyContact">联系：如有隐私相关问题，请联系 contact@softlyflow.com。</li>
      </ul>
    </div>

    <div class="footer">
      <p data-translate="privacyNotice">温暖承诺：所有数据仅存储在您的设备上，保护您的内心世界。我们不会收集任何个人信息。</p>
    </div>
  </div>

  <script>
    // 全局函数定义
    let currentQuoteData = {
      text: '每一个今天都是昨天死去的人期待的明天。', // 设置初始语录
      likes: 0,
      isLiked: false,
      isFavorited: false,
      comments: []
    };
    let quoteHistory = JSON.parse(localStorage.getItem('quoteHistory') || '[]');
    
    function updateQuoteUI() {
      console.log('updateQuoteUI被调用，当前数据:', currentQuoteData);
      
      // 延迟执行，确保DOM完全加载
      setTimeout(() => {
        const likeBtn = document.getElementById('likeBtn');
        const favoriteBtn = document.getElementById('favoriteBtn');
        const likeCount = document.getElementById('likeCount');
        
        console.log('延迟后找到的元素:', {
          likeBtn: !!likeBtn,
          favoriteBtn: !!favoriteBtn,
          likeCount: !!likeCount
        });
        
        if (likeBtn && favoriteBtn && likeCount) {
          // 更新点赞状态
          likeBtn.classList.toggle('liked', currentQuoteData.isLiked);
          likeCount.textContent = currentQuoteData.likes;
          
          // 更新收藏状态
          favoriteBtn.classList.toggle('favorited', currentQuoteData.isFavorited);
          
          console.log('UI更新完成，点赞数:', currentQuoteData.likes, '点赞状态:', currentQuoteData.isLiked);
        } else {
          console.log('部分元素未找到，无法更新UI');
          console.log('likeBtn:', likeBtn);
          console.log('favoriteBtn:', favoriteBtn);
          console.log('likeCount:', likeCount);
        }
      }, 100);
    }
    
    function toggleLike() {
      console.log('toggleLike被调用');
      
      if (currentQuoteData.isLiked) {
        currentQuoteData.likes--;
        currentQuoteData.isLiked = false;
      } else {
        currentQuoteData.likes++;
        currentQuoteData.isLiked = true;
      }
      
      console.log('点赞后状态:', currentQuoteData);
      
      // 直接更新UI元素
      const likeBtn = document.getElementById('likeBtn');
      const likeCount = document.getElementById('likeCount');
      
      if (likeBtn && likeCount) {
        likeBtn.classList.toggle('liked', currentQuoteData.isLiked);
        likeCount.textContent = currentQuoteData.likes;
        console.log('直接更新UI成功');
      } else {
        console.log('直接更新UI失败，元素未找到');
      }
      
      updateQuoteUI();
      saveQuoteData();
    }
    
    function toggleFavorite() {
      currentQuoteData.isFavorited = !currentQuoteData.isFavorited;
      updateQuoteUI();
      saveQuoteData();
    }
    
    function toggleComments() {
      const commentsContainer = document.getElementById('quoteComments');
      if (commentsContainer) {
        const isVisible = commentsContainer.style.display !== 'none';
        commentsContainer.style.display = isVisible ? 'none' : 'block';
        
        if (!isVisible) {
          renderComments();
        }
      }
    }
    
    function renderComments() {
      const commentsList = document.getElementById('commentsList');
      if (!commentsList) return;
      
      if (currentQuoteData.comments.length === 0) {
        const noCommentsText = '还没有评论，来分享你的感受吧~';
        commentsList.innerHTML = `<div style="text-align: center; color: #A0522D; font-style: italic;">${noCommentsText}</div>`;
        return;
      }
      
      commentsList.innerHTML = currentQuoteData.comments.map(comment => `
        <div class="comment-item">
          <div class="comment-text">${comment.text}</div>
          <div class="comment-meta">
            <span>${comment.time}</span>
            <span>❤️ ${comment.likes || 0}</span>
          </div>
        </div>
      `).join('');
    }
    
    function addComment() {
      const commentText = document.getElementById('commentText');
      if (!commentText || !commentText.value.trim()) return;
      
      const newComment = {
        text: commentText.value.trim(),
        time: new Date().toLocaleString(),
        likes: 0
      };
      
      currentQuoteData.comments.push(newComment);
      commentText.value = '';
      
      renderComments();
      saveQuoteData();
    }
    
    function saveQuoteData() {
      // 保存到本地存储
      const existingIndex = quoteHistory.findIndex(item => item.text === currentQuoteData.text);
      if (existingIndex >= 0) {
        quoteHistory[existingIndex] = { ...currentQuoteData };
      } else {
        quoteHistory.push({ ...currentQuoteData });
      }
      
      // 限制历史记录数量
      if (quoteHistory.length > 100) {
        quoteHistory = quoteHistory.slice(-100);
      }
      
      localStorage.setItem('quoteHistory', JSON.stringify(quoteHistory));
    }
    
    document.addEventListener('DOMContentLoaded', function () {
      console.log('页面加载完成，开始初始化');
  // 多语言
  const translations = {
    'zh-CN': { title:'数字圣所', subtitle:'你的宁静治愈空间', currentLang:'简体中文',
      navQuote:'每日治愈语录', navMystic:'心灵探索', navGames:'放松游戏', navPsychology:'心灵角落',
      navBreathing:'呼吸疗愈', navJournal:'心灵日记', navSounds:'自然疗愈', navBlog:'治愈博客',
      newQuote:'新语录', likeQuote:'点赞', favoriteQuote:'收藏', commentQuote:'评论', submitComment:'发表评论', commentPlaceholder:'写下你的感受...', noComments:'还没有评论，来分享你的感受吧~', moodCheck:'检查心情', moodQuestion:'今天的心灵感受如何？', moodHappy:'开心 😊', moodCalm:'平静 😌', moodAnxious:'焦虑 😰', moodSad:'难过 😢', moodTired:'疲惫 😴',
      saveJournal:'保存心灵记录', viewJournal:'查看成长轨迹', clearJournal:'清空记录', playSound:'播放',
      soundRain:'雨声', soundOcean:'海浪声', soundForest:'森林鸟鸣', breathingInstructions:'跟随圆圈进行4-7-8呼吸疗愈，让身心回归平静',
      journalPlaceholder:'写下你今天的内心感受，让文字成为心灵的镜子...',
      gameBubble:'泡泡游戏', gameSand:'沙画板', bubbleInstructions:'点击泡泡来消除它们', sandInstructions:'在画布上绘制你的想法', scoreText:'得分: ', privacyNotice:'温暖承诺：所有数据仅存储在您的设备上，保护您的内心世界。我们不会收集任何个人信息。',
      navHome:'首页', navFeatures:'功能', navAbout:'关于我们', navPrivacy:'隐私政策',
      heroTitle:'温暖治愈，心灵港湾', heroSubtitle:'在这里，让疲惫的心灵找到归属，让温暖的自然力量治愈你的每一天。', ctaStart:'开始治愈之旅', ctaExplore:'探索治愈功能',
      fQuote:'每日治愈语录', fQuoteDesc:'温暖人心的智慧话语，点亮每一天', fBreath:'呼吸疗愈', fBreathDesc:'4-7-8 呼吸法，让身心回归平静',
      fMystic:'心灵探索', fMysticDesc:'塔罗/星座/幸运饼干，发现内心的答案', fGames:'放松游戏', fGamesDesc:'泡泡/沙画，在游戏中释放压力',
      fJournal:'心灵日记', fJournalDesc:'记录内心感受，见证成长轨迹', fSounds:'自然疗愈', fSoundsDesc:'雨声/海浪/鸟鸣，大自然的治愈力量',
      aboutP1:'治愈空间致力于以温暖自然的设计与科学方法，为疲惫的心灵提供温暖、可持续的自我疗愈空间。',
      aboutP2:'我们相信：真正的治愈来自内心的平静与自然的温暖。在这里，让每一次呼吸都成为治愈的开始。',
      aboutValue1:'温暖与科学', aboutValue1D:'结合心理学与自然疗法，以温暖的感官体验实现心灵治愈。',
      aboutValue2:'自然与可达', aboutValue2D:'跨设备无障碍，低认知负担，随时找到心灵的港湾。',
      aboutValue3:'隐私与信任', aboutValue3D:'数据仅存本地，无账号、无追踪，保护你的内心世界。',
      privacyIntro:'我们尊重并保护你的隐私。除非你手动导出，否则数据仅存储在你的设备本地。',
      privacyLocal:'本地存储：日记与偏好通过浏览器 localStorage 保存在你的设备上。',
      privacyNoCollect:'不收集：我们不采集可识别个人信息。',
      privacyThird:'第三方：如后续接入第三方音频/分析服务，将在此更新并提供选择退出。',
      privacyContact:'联系：如有隐私相关问题，请联系 contact@softlyflow.com。'
    },
    'zh-TW': { title:'數位聖所', subtitle:'你的寧靜治癒空間', currentLang:'繁體中文',
      navQuote:'每日治癒語錄', navMystic:'心靈探索', navGames:'放鬆遊戲', navPsychology:'心靈角落',
      navBreathing:'呼吸療癒', navJournal:'心靈日記', navSounds:'自然療癒', navBlog:'療癒部落格',
      newQuote:'新語錄', likeQuote:'點讚', favoriteQuote:'收藏', commentQuote:'評論', submitComment:'發表評論', commentPlaceholder:'寫下你的感受...', noComments:'還沒有評論，來分享你的感受吧~', moodCheck:'檢查心情', moodQuestion:'今天的心靈感受如何？', moodHappy:'開心 😊', moodCalm:'平靜 😌', moodAnxious:'焦慮 😰', moodSad:'難過 😢', moodTired:'疲憊 😴',
      saveJournal:'保存心靈記錄', viewJournal:'查看成長軌跡', clearJournal:'清空記錄', playSound:'播放',
      soundRain:'雨聲', soundOcean:'海浪聲', soundForest:'森林鳥鳴', breathingInstructions:'跟隨圓圈進行4-7-8呼吸療癒，讓身心回歸平靜',
      journalPlaceholder:'寫下你今天的心靈感受，讓文字成為心靈的鏡子...',
      gameBubble:'泡泡遊戲', gameSand:'沙畫板', bubbleInstructions:'點擊泡泡來消除它們', sandInstructions:'在畫布上繪製你的想法', scoreText:'得分: ', privacyNotice:'隱私聲明：所有數據僅存儲在您的設備上。我們不會收集任何個人信息。',
      navHome:'首頁', navFeatures:'功能', navAbout:'關於我們', navPrivacy:'隱私政策',
      heroTitle:'讓身心歸於鬆弛', heroSubtitle:'以更少的界面負擔，回到更好的自己。', ctaStart:'開始治癒', ctaExplore:'探索功能',
      fQuote:'每日禪語', fQuoteDesc:'自動更新短句，隨時獲得鼓勵', fBreath:'呼吸練習', fBreathDesc:'4-7-8 循環，重啟身心節律',
      fMystic:'玄學區域', fMysticDesc:'塔羅/星座/幸運餅乾，更多互動', fGames:'減壓遊戲', fGamesDesc:'泡泡/沙畫，放鬆專注',
      fJournal:'情感日記', fJournalDesc:'本地保存，記錄每次心緒', fSounds:'自然音效', fSoundsDesc:'雨/海/森林，混音與音量',
      aboutP1:'SoftlyFlow 致力於以極簡設計與科學方法，為高壓力群體提供穩定、可持續的自我修復空間。',
      aboutP2:'我們相信：好的設計不打擾，只陪伴。你只需一點點時間，餘下的交給節律和呼吸。',
      aboutValue1:'科學與審美', aboutValue1D:'結合心理學與呼吸節律，以舒緩的感官體驗實現自我調節。',
      aboutValue2:'極簡與可達', aboutValue2D:'跨設備無障礙，低認知負擔，隨用隨走。',
      aboutValue3:'隱私優先', aboutValue3D:'數據僅存本地，無帳號、無追蹤。',
      privacyIntro:'我們尊重並保護你的隱私。除非你手動導出，否則數據僅存儲在你的設備本地。',
      privacyLocal:'本地存儲：日記與偏好通過瀏覽器 localStorage 保存在你的設備上。',
      privacyNoCollect:'不收集：我們不採集可識別個人信息。',
      privacyThird:'第三方：如後續接入第三方音頻/分析服務，將在此更新並提供選擇退出。',
      privacyContact:'聯繫：如有隱私相關問題，請聯繫 contact@softlyflow.com。'
    },
    en: { title:'Digital Sanctuary', subtitle:'Your peaceful healing space', currentLang:'English',
      navQuote:'Daily Healing Quotes', navMystic:'Soul Exploration', navGames:'Relaxing Games', navPsychology:'Soul Corner',
      navBreathing:'Breathing Healing', navJournal:'Soul Journal', navSounds:'Nature Healing', navBlog:'Healing Blog',
      newQuote:'New Quote', likeQuote:'Like', favoriteQuote:'Favorite', commentQuote:'Comment', submitComment:'Submit Comment', commentPlaceholder:'Write your feelings...', noComments:'No comments yet, share your feelings~', moodCheck:'Check Mood', moodQuestion:'How is your soul feeling today?', moodHappy:'Happy 😊', moodCalm:'Calm 😌', moodAnxious:'Anxious 😰', moodSad:'Sad 😢', moodTired:'Tired 😴',
      saveJournal:'Save Soul Record', viewJournal:'View Growth Path', clearJournal:'Clear Records', playSound:'Play',
      soundRain:'Rain Sound', soundOcean:'Ocean Waves', soundForest:'Forest Birds', breathingInstructions:'Follow the circle for 4-7-8 breathing healing to restore body and mind to peace',
      journalPlaceholder:'Write down your inner feelings today, let words become a mirror of your soul...',
      gameBubble:'Bubble Game', gameSand:'Sand Canvas', bubbleInstructions:'Click bubbles to pop them', sandInstructions:'Draw your thoughts on the canvas', scoreText:'Score: ', privacyNotice:'Privacy Notice: All data is stored locally on your device only. We do not collect any personal information.',
      navHome:'Home', navFeatures:'Features', navAbout:'About Us', navPrivacy:'Privacy Policy',
      heroTitle:'Let Your Mind and Body Relax', heroSubtitle:'With fewer interface burdens, return to a better self.', ctaStart:'Start Healing', ctaExplore:'Explore Features',
      fQuote:'Daily Quotes', fQuoteDesc:'Automatically update short phrases for encouragement at any time.',
      fBreath:'Breathing Exercise', fBreathDesc:'4-7-8 cycle, reboot your physical and mental rhythm.',
      fMystic:'Mystic Zone', fMysticDesc:'Tarot, astrology, lucky cookie, more interaction.',
      fGames:'Relaxing Games', fGamesDesc:'Bubble/Sand art, relaxation and focus.',
      fJournal:'Emotional Journal', fJournalDesc:'Local saving, record every mood.',
      fSounds:'Nature Sounds', fSoundsDesc:'Rain/Ocean/Forest, mixed and volume.',
      aboutP1:'SoftlyFlow is committed to providing a stable, sustainable self-repair space for high-pressure groups through minimalist design and scientific methods.',
      aboutP2:'We believe that good design does not disturb, only accompanies. You just need a little time, and the rest is entrusted to rhythm and breathing.',
      aboutValue1:'Science and Aesthetics', aboutValue1D:'Combining psychology and breathing rhythm to achieve self-regulation through a soothing sensory experience.',
      aboutValue2:'Minimalism and Accessibility', aboutValue2D:'Cross-device accessibility, low cognitive burden, use and go.',
      aboutValue3:'Privacy Priority', aboutValue3D:'Data is only stored locally, no account, no tracking.',
      privacyIntro:'We respect and protect your privacy. Unless you manually export, data is only stored locally on your device.',
      privacyLocal:'Local Storage: Diary and preferences are saved on your device via browser localStorage.',
      privacyNoCollect:'No Collection: We do not collect identifiable personal information.',
      privacyThird:'Third Party: If third-party audio/analysis services are subsequently integrated, this will be updated and provided with an opt-out option here.',
      privacyContact:'Contact: If you have any privacy-related questions, please contact contact@softlyflow.com.'
    },
    ko: { title:'디지털 성소', subtitle:'당신의 평화로운 치유 공간', currentLang:'한국어',
      navQuote:'일일 치유 문구', navMystic:'영혼 탐색', navGames:'스트레스 해소', navPsychology:'영혼 코너',
      navBreathing:'호흡 치유', navJournal:'영혼 일기', navSounds:'자연 치유', navBlog:'힐링 블로그',
      newQuote:'새 인용문', likeQuote:'좋아요', favoriteQuote:'즐겨찾기', commentQuote:'댓글', submitComment:'댓글 작성', commentPlaceholder:'당신의 감정을 적어보세요...', noComments:'아직 댓글이 없습니다, 당신의 감정을 공유해보세요~', moodCheck:'기분 확인', moodQuestion:'오늘 영혼의 감정은 어떠신가요?', moodHappy:'행복 😊', moodCalm:'평온 😌', moodAnxious:'불안 😰', moodSad:'슬픔 😢', moodTired:'피곤 😴',
      saveJournal:'영혼 기록 저장', viewJournal:'성장 궤적 보기', clearJournal:'기록 지우기', playSound:'재생',
      soundRain:'빗소리', soundOcean:'파도 소리', soundForest:'숲새 소리', breathingInstructions:'원을 따라 4-7-8 호흡 치유를 하여 몸과 마음을 평온으로 되돌리세요',
      journalPlaceholder:'오늘의 내면 감정을 적어보세요, 글이 영혼의 거울이 되도록...',
      gameBubble:'버블 게임', gameSand:'모래 캔버스', bubbleInstructions:'버블을 클릭하여 터뜨리세요', sandInstructions:'캔버스에 당신의 생각을 그려보세요', scoreText:'점수: ', privacyNotice:'개인정보 보호: 모든 데이터는 기기에만 로컬로 저장됩니다. 개인정보를 수집하지 않습니다.',
      navHome:'홈', navFeatures:'기능', navAbout:'소개', navPrivacy:'개인정보 처리 방침',
      heroTitle:'마음과 몸을 편안하게 하세요', heroSubtitle:'더 적은 인터페이스 부담으로 더 나은 자신으로 돌아가세요.', ctaStart:'치유 시작', ctaExplore:'기능 탐색',
      fQuote:'일일 선문', fQuoteDesc:'자동으로 짧은 문구를 업데이트하여 언제든지 격려를 얻으세요.',
      fBreath:'호흡 운동', fBreathDesc:'4-7-8 사이클, 신체와 정신의 리듬을 재시작하세요.',
      fMystic:'신비한 영역', fMysticDesc:'타로, 별자리, 행운 과자, 더 많은 상호작용.',
      fGames:'스트레스 해소', fGamesDesc:'버블/모래 그림, 집중과 안정.',
      fJournal:'감정 일기', fJournalDesc:'로컬 저장, 매일 마음 기록.',
      fSounds:'자연음', fSoundsDesc:'비/바다/숲, 혼합과 볼륨.',
      aboutP1:'SoftlyFlow는 미니멀리스틱 디자인과 과학적 방법을 통해 고압력 그룹에게 안정적이고 지속 가능한 자기 치유 공간을 제공하는 것을 목표로 합니다.',
      aboutP2:'우리는 좋은 디자인이 방해하지 않는다고 믿습니다. 당신은 단지 조금의 시간만 필요하고, 나머지는 리듬과 호흡에 맡기세요.',
      aboutValue1:'과학과 미학', aboutValue1D:'심리학과 호흡 리듬을 결합하여 완화된 감각 경험을 통해 자기 조절을 실현합니다.',
      aboutValue2:'미니멀리즘과 접근성', aboutValue2D:'교차 기기 접근성, 낮은 인지 부담, 언제든지 사용하세요.',
      aboutValue3:'개인정보 우선', aboutValue3D:'데이터는 로컬에만 저장되며, 계정이 없고 추적되지 않습니다.',
      privacyIntro:'우리는 개인정보를 존중하고 보호합니다. 수동으로 내보내지 않는 한 데이터는 당신의 기기에만 저장됩니다.',
      privacyLocal:'로컬 저장: 일기와 선호도는 브라우저 localStorage를 통해 당신의 기기에 저장됩니다.',
      privacyNoCollect:'수집하지 않음: 식별 가능한 개인정보를 수집하지 않습니다.',
      privacyThird:'제3자: 향후 제3자 오디오/분석 서비스를 통합하는 경우, 이 부분을 업데이트하고 선택 해제 옵션을 제공합니다.',
      privacyContact:'문의: 개인정보 관련 문의가 있으시면 contact@softlyflow.com으로 문의해 주세요.'
    },
    ja: { title:'デジタル聖所', subtitle:'あなたの静寂な癒しの空間', currentLang:'日本語',
      navQuote:'日々の癒しの言葉', navMystic:'心の探求', navGames:'ストレス解消', navPsychology:'心のコーナー',
      navBreathing:'呼吸癒し', navJournal:'心の日記', navSounds:'自然癒し', navBlog:'癒しブログ',
      newQuote:'新しい引用', likeQuote:'いいね', favoriteQuote:'お気に入り', commentQuote:'コメント', submitComment:'コメント投稿', commentPlaceholder:'あなたの気持ちを書いてください...', noComments:'まだコメントがありません、あなたの気持ちを共有しましょう~', moodCheck:'気分チェック', moodQuestion:'今日の心の感情はどうですか？', moodHappy:'幸せ 😊', moodCalm:'穏やか 😌', moodAnxious:'不安 😰', moodSad:'悲しい 😢', moodTired:'疲れた 😴',
      saveJournal:'心の記録を保存', viewJournal:'成長の軌跡を見る', clearJournal:'記録をクリア', playSound:'再生',
      soundRain:'雨の音', soundOcean:'波の音', soundForest:'森の鳥の声', breathingInstructions:'円に従って4-7-8呼吸癒しを行い、心身を平穏に戻しましょう',
      journalPlaceholder:'今日の心の感情を書き留めてください、文字が心の鏡になるように...',
      gameBubble:'バブルゲーム', gameSand:'砂キャンバス', bubbleInstructions:'バブルをクリックして割ってください', sandInstructions:'キャンバスにあなたの考えを描いてください', scoreText:'スコア: ', privacyNotice:'プライバシー: すべてのデータはお客様のデバイスにのみ保存されます。個人情報は収集いたしません。',
      navHome:'ホーム', navFeatures:'機能', navAbout:'私たちについて', navPrivacy:'プライバシーポリシー',
      heroTitle:'心と体を弛緩させましょう', heroSubtitle:'より少ないインターフェース負担で、より良い自分に戻りましょう。', ctaStart:'癒しを始める', ctaExplore:'機能を探索',
      fQuote:'日々の禅', fQuoteDesc:'いつでも励ましの短い文を自動更新します。',
      fBreath:'呼吸練習', fBreathDesc:'4-7-8サイクルで、身体と精神的リズムをリセットします。',
      fMystic:'神秘の領域', fMysticDesc:'タロット、星座、幸運のクッキー、より多くのインタラクション。',
      fGames:'ストレス解消', fGamesDesc:'バブル/砂画、集中と安定。',
      fJournal:'感情日記', fJournalDesc:'ローカル保存、毎日の気分を記録。',
      fSounds:'自然音', fSoundsDesc:'雨/海/森、ミックスと音量。',
      aboutP1:'SoftlyFlowは、ミニマリストデザインと科学的方法を通じて、高圧力グループに対して安定して持続可能な自己修復空間を提供することを目指しています。',
      aboutP2:'私たちは、良いデザインは邪魔をしないと信じています。あなたはただ少しの時間が必要です。残りはリズムと呼吸に任せましょう。',
      aboutValue1:'科学と美', aboutValue1D:'心理学と呼吸リズムを組み合わせて、和らぎの感覚体験を通じて自己調整を実現します。',
      aboutValue2:'ミニマリズムとアクセシビリティ', aboutValue2D:'クロスデバイスアクセシビリティ、低認知負担、いつでも使用可能。',
      aboutValue3:'プライバシー優先', aboutValue3D:'データはローカルにのみ保存され、アカウントも追跡もありません。',
      privacyIntro:'私たちは個人情報を尊重し、保護します。手動でエクスポートしない限り、データはお客様のデバイスにのみ保存されます。',
      privacyLocal:'ローカル保存：日記と設定はブラウザのlocalStorageを通じてお客様のデバイスに保存されます。',
      privacyNoCollect:'収集しない：個人を特定できる情報は収集しません。',
      privacyThird:'第3者：後続の第3者オーディオ/分析サービスへの統合がある場合、ここで更新し、オプトアウトオプションを提供します。',
      privacyContact:'お問い合わせ：個人情報に関するお問い合わせがありましたら、contact@softlyflow.comまでお問い合わせください。'
    }
  };

  // 语录
  const quotes = {
    'zh-CN': [
      '每一个今天都是昨天死去的人期待的明天。','生活不是等待暴风雨过去，而是学会在雨中起舞。',
      '你现在的努力，是你未来的底气。','世界以痛吻我，我却报之以歌。','山有峰顶，海有彼岸，漫漫长途，终有回转。',
      '星光不问赶路人，岁月不负有心人。','愿你有好运，如果没有，愿你在不幸中学会慈悲。',
      '生命中最重要的不是所站的位置，而是所朝的方向。','风会穿过你，也会吹散你身上的尘埃。','在黑夜中行走，也要心向光明。',
      '慢慢来比较快。','当你开始爱自己，世界就会向你打开一道门。',
      '温柔不是软弱，而是一种选择。选择看到美好，选择相信希望。',
      '有时候，最勇敢的事情就是承认自己需要帮助。',
      '你不需要成为任何人，只需要成为最好的自己。',
      '每一个微笑背后，都有一段不为人知的故事。',
      '时间会治愈一切，但首先你要给自己时间。',
      '当你感到孤独时，请记住：星星也在孤独中闪耀。',
      '成长不是变得完美，而是学会接纳不完美。',
      '有时候，最好的安慰就是静静的陪伴。',
      '你的价值不在于你拥有什么，而在于你是谁。',
      '每一个结束都是新的开始，每一个失去都是另一种得到。',
      '当你感到迷茫时，请相信内心的声音，它知道答案。',
      '爱自己不是自私，而是自爱。只有爱自己，才能更好地爱别人。',
      '生活就像一本书，每一天都是新的一页。',
      '不要害怕犯错，因为错误是成长的老师。',
      '你的存在本身就是一种奇迹，无需证明给任何人看。',
      '有时候，最深的治愈来自于最简单的善意。',
      '当你感到疲惫时，请记住：休息不是懒惰，而是为了更好的前行。',
      '每一个挑战都是成长的机会，每一次跌倒都是站起来的勇气。',
      '你的故事值得被倾听，你的感受值得被理解。',
      '温柔地对待自己，就像对待一个需要关爱的朋友。',
      '当你感到无助时，请记住：你比自己想象的要坚强得多。'
    ],
    'zh-TW': [
      '每一個今天都是昨天死去的人期待的明天。','生活不是等待暴風雨過去，而是學會在雨中起舞。',
      '你現在的努力，是你未來的底氣。','世界以痛吻我，我卻報之以歌。','山有峰頂，海有彼岸，漫長長途，終有回轉。',
      '星光不問趕路人，歲月不負有心人。','願你有好運，如果沒有，願你在不幸中學會慈悲。',
      '生命中最重要的不是所站的位置，而是所朝的方向。','風會穿過你，也會吹散你身上的塵埃。','在黑夜中行走，也要心向光明。',
      '慢慢來比較快。','當你開始愛自己，世界就會向你打開一道門。',
      '溫柔不是軟弱，而是一種選擇。選擇看到美好，選擇相信希望。',
      '有時候，最勇敢的事情就是承認自己需要幫助。',
      '你不需要成為任何人，只需要成為最好的自己。',
      '每一個微笑背後，都有一段不為人知的故事。',
      '時間會治癒一切，但首先你要給自己時間。',
      '當你感到孤獨時，請記住：星星也在孤獨中閃耀。',
      '成長不是變得完美，而是學會接納不完美。',
      '有時候，最好的安慰就是靜靜的陪伴。',
      '你的價值不在於你擁有什麼，而在於你是誰。',
      '每一個結束都是新的開始，每一個失去都是另一種得到。',
      '當你感到迷茫時，請相信內心的聲音，它知道答案。',
      '愛自己不是自私，而是自愛。只有愛自己，才能更好地愛別人。',
      '生活就像一本書，每一天都是新的一頁。',
      '不要害怕犯錯，因為錯誤是成長的老師。',
      '你的存在本身就是一種奇蹟，無需證明給任何人看。',
      '有時候，最深的治癒來自於最簡單的善意。',
      '當你感到疲憊時，請記住：休息不是懶惰，而是為了更好的前行。',
      '每一個挑戰都是成長的機會，每一次跌倒都是站起來的勇氣。',
      '你的故事值得被傾聽，你的感受值得被理解。',
      '溫柔地對待自己，就像對待一個需要關愛的朋友。',
      '當你感到無助時，請記住：你比自己想像的要堅強得多。'
    ],
    en: [
      "Life isn't about waiting for the storm to pass; it's about learning to dance in the rain.",
      "Stars don't ask travelers; time won't fail the devoted.",
      'Small steps every day lead to big changes.',
      "Gentleness is not weakness; it's a choice to see beauty and believe in hope.",
      "Sometimes the bravest thing you can do is admit you need help.",
      "You don't need to be anyone else; just be the best version of yourself.",
      "Behind every smile, there's a story no one knows.",
      "Time heals everything, but first you have to give yourself time.",
      "When you feel lonely, remember: stars shine brightest in solitude.",
      "Growth isn't about becoming perfect; it's about accepting imperfection.",
      "Sometimes the best comfort is simply being present.",
      "Your worth isn't in what you have, but in who you are.",
      "Every ending is a new beginning; every loss is another kind of gain.",
      "When you feel lost, trust your inner voice; it knows the way.",
      "Loving yourself isn't selfish; it's self-care. Only by loving yourself can you love others better.",
      "Life is like a book; every day is a new page.",
      "Don't be afraid to make mistakes; they are the teachers of growth.",
      "Your existence itself is a miracle; you don't need to prove anything to anyone.",
      "Sometimes the deepest healing comes from the simplest kindness.",
      "When you feel tired, remember: rest isn't laziness; it's preparation for better progress.",
      "Every challenge is an opportunity for growth; every fall is courage to rise again.",
      "Your story deserves to be heard; your feelings deserve to be understood.",
      "Be gentle with yourself, as you would be with a friend in need.",
      "When you feel helpless, remember: you are stronger than you think."
    ],
    ko: [
      '오늘의 작은 걸음이 내일의 큰 변화를 만든다.',
      '부드러움은 약함이 아니라 아름다움을 보고 희망을 믿는 선택이다.',
      '때로는 도움이 필요하다고 인정하는 것이 가장 용감한 일이다.',
      '다른 사람이 될 필요는 없다; 그냥 최고의 자신이 되면 된다.',
      '모든 미소 뒤에는 아무도 모르는 이야기가 있다.',
      '시간이 모든 것을 치유하지만, 먼저 자신에게 시간을 주어야 한다.',
      '외로움을 느낄 때 기억하라: 별들은 고독 속에서 가장 밝게 빛난다.',
      '성장은 완벽해지는 것이 아니라 불완전함을 받아들이는 것이다.',
      '때로는 단순히 함께 있는 것이 최고의 위안이다.',
      '당신의 가치는 가진 것에 있지 않고, 당신이 누구인가에 있다.',
      '모든 끝은 새로운 시작이고, 모든 잃음은 또 다른 종류의 얻음이다.',
      '길을 잃었다고 느낄 때, 내면의 소리를 믿으라; 그것이 길을 알고 있다.',
      '자신을 사랑하는 것은 이기적이 아니다; 그것은 자기 돌봄이다. 자신을 사랑해야만 다른 사람을 더 잘 사랑할 수 있다.',
      '인생은 책과 같다; 매일이 새로운 페이지다.',
      '실수하는 것을 두려워하지 마라; 그것들은 성장의 스승이다.',
      '당신의 존재 자체가 기적이다; 누구에게도 증명할 필요가 없다.',
      '때로는 가장 깊은 치유가 가장 단순한 친절에서 온다.',
      '피곤함을 느낄 때 기억하라: 휴식은 게으름이 아니라 더 나은 전진을 위한 준비다.',
      '모든 도전은 성장의 기회이고, 모든 넘어짐은 다시 일어설 용기다.',
      '당신의 이야기는 들릴 가치가 있고, 당신의 감정은 이해받을 가치가 있다.',
      '필요한 친구를 대하듯 자신을 부드럽게 대하라.',
      '무력함을 느낄 때 기억하라: 당신은 생각보다 훨씬 강하다.'
    ],
          ja: [
        '小さな一歩が、やがて大きな変化になる。',
        '優しさは弱さではなく、美しさを見て希望を信じる選択である。',
        '時には助けが必要だと認めることが最も勇敢なことである。',
        '他の誰かになる必要はない；ただ最高の自分になればいい。',
        'すべての笑顔の裏には、誰も知らない物語がある。',
        '時間がすべてを癒すが、まず自分に時間を与える必要がある。',
        '孤独を感じるときは覚えておいて：星は孤独の中で最も明るく輝く。',
        '成長は完璧になることではなく、不完全さを受け入れることである。',
        '時には、ただ一緒にいることが最高の慰めである。',
        'あなたの価値は持っているものではなく、あなたが誰であるかにある。',
        'すべての終わりは新しい始まりであり、すべての失いは別の種類の得である。',
        '迷いを感じるときは、内なる声を信じなさい；それは道を知っている。',
        '自分を愛することは利己的ではない；それは自己ケアである。自分を愛してこそ、他の人をより良く愛せる。',
        '人生は本のようなもの；毎日が新しいページである。',
        '間違いを恐れないで；それらは成長の教師である。',
        'あなたの存在そのものが奇跡である；誰にも証明する必要はない。',
        '時には最も深い癒しが最もシンプルな親切から来る。',
        '疲れを感じるときは覚えておいて：休息は怠惰ではなく、より良い前進のための準備である。',
        'すべての挑戦は成長の機会であり、すべての転倒は再び立ち上がる勇気である。',
        'あなたの物語は聞かれる価値があり、あなたの感情は理解される価値がある。',
        '必要な友達を扱うように、自分を優しく扱いなさい。',
        '無力感を感じるときは覚えておいて：あなたは思っているよりずっと強い。'
      ]
  };

  // 博客多语言数据
  const blogPosts = {
    'zh-CN': [
      {
        title: '什么是「治愈系」？从科学与感性两端看松弛感',
        date: '2025-08-01',
        tags: ['心理学','正念','减压'],
        summary: '「治愈系」并非逃避，而是调节。本文从神经生理到日常练习，聊聊松弛背后的原理与方法。',
        content: '我们常把「治愈系」理解为温柔的色彩与舒缓的音乐，但其本质是生理-心理的协同调节……'
      },
      {
        title: '三分钟正念：随时可做的微练习',
        date: '2025-08-05',
        tags: ['呼吸','专注','练习'],
        summary: '没有时间也能练正念？三组微练习教你把碎片时间变成恢复时间。',
        content: '练习一：四拍吸、四拍停、四拍呼、四拍停……'
      }
    ],
    'zh-TW': [
      {
        title: '什麼是「治癒系」？從科學與感性兩端看鬆弛感',
        date: '2025-08-01',
        tags: ['心理學','正念','減壓'],
        summary: '「治癒系」並非逃避，而是調節。本文從神經生理到日常練習，聊聊鬆弛背後的原理與方法。',
        content: '我們常把「治癒系」理解為溫柔的色彩與舒緩的音樂，但其本質是生理-心理的協同調節……'
      },
      {
        title: '三分鐘正念：隨時可做的微練習',
        date: '2025-08-05',
        tags: ['呼吸','專注','練習'],
        summary: '沒有時間也能練正念？三組微練習教你把碎片時間變成恢復時間。',
        content: '練習一：四拍吸、四拍停、四拍呼、四拍停……'
      }
    ],
    en: [
      {
        title: 'What is "Healing"? Understanding Relaxation from Science and Sensibility',
        date: '2025-08-01',
        tags: ['Psychology','Mindfulness','Stress Relief'],
        summary: '"Healing" is not about escaping, but about regulation. This article explores the principles and methods behind relaxation from neurophysiology to daily practice.',
        content: 'We often understand "healing" as gentle colors and soothing music, but its essence is the synergistic regulation of physiology and psychology...'
      },
      {
        title: 'Three-Minute Mindfulness: Micro-practices You Can Do Anytime',
        date: '2025-08-05',
        tags: ['Breathing','Focus','Practice'],
        summary: 'No time for mindfulness? Three micro-practices teach you how to turn fragmented time into recovery time.',
        content: 'Practice 1: Four counts inhale, four counts hold, four counts exhale, four counts hold...'
      }
    ],
    ko: [
      {
        title: '"치유"란 무엇인가? 과학과 감성에서 보는 이완감',
        date: '2025-08-01',
        tags: ['심리학','마음챙김','스트레스 해소'],
        summary: '"치유"는 도피가 아니라 조절입니다. 이 글은 신경생리학부터 일상 연습까지 이완 뒤의 원리와 방법을 다룹니다.',
        content: '우리는 종종 "치유"를 부드러운 색과 편안한 음악으로 이해하지만, 그 본질은 생리-심리의 협동 조절입니다...'
      },
      {
        title: '3분 마음챙김: 언제든 할 수 있는 마이크로 연습',
        date: '2025-08-05',
        tags: ['호흡','집중','연습'],
        summary: '마음챙김을 할 시간이 없나요? 세 가지 마이크로 연습으로 조각난 시간을 회복 시간으로 바꾸는 법을 가르칩니다.',
        content: '연습 1: 4박자 들이쉬기, 4박자 멈추기, 4박자 내쉬기, 4박자 멈추기...'
      }
    ],
    ja: [
      {
        title: '「癒し」とは何か？科学と感性から見る弛緩感',
        date: '2025-08-01',
        tags: ['心理学','マインドフルネス','ストレス解消'],
        summary: '「癒し」は逃避ではなく、調節です。この記事は神経生理学から日常練習まで、弛緩の背後にある原理と方法について話します。',
        content: '私たちは「癒し」を優しい色と心地よい音楽として理解することが多いですが、その本質は生理-心理の協調調節です...'
      },
      {
        title: '3分マインドフルネス：いつでもできるマイクロ練習',
        date: '2025-08-05',
        tags: ['呼吸','集中','練習'],
        summary: 'マインドフルネスの時間がない？3つのマイクロ練習で断片的な時間を回復時間に変える方法を教えます。',
        content: '練習1：4拍吸う、4拍止める、4拍吐く、4拍止める...'
      }
    ]
  };

  // 状态与元素
  let currentLang = localStorage.getItem('lang') || 'zh-CN';
  let bubbleScore = 0;
  let quoteTimer = null;
  let breathingPhase = 0;
  

  const breathingTextEl = document.getElementById('breathingText');
  const breathingTexts = {
    'zh-CN': ['吸气 (4秒)','屏息 (7秒)','呼气 (8秒)','准备...'],
    'zh-TW': ['吸氣 (4秒)','屏息 (7秒)','呼氣 (8秒)','準備...'],
    en: ['Breathe In (4s)','Hold (7s)','Breathe Out (8s)','Prepare...'],
    ko: ['들어쉬기 (4초)','멈추기 (7초)','내쉬기 (8초)','준비...'],
    ja: ['吸う (4秒)','止める (7秒)','吐く (8秒)','準備...']
  };
  const breathingDurations = [4000,7000,8000,1000];

  const languageBtn = document.getElementById('languageBtn');
  const dropdown = document.getElementById('languageDropdown');
  const languageOptions = document.querySelectorAll('.language-option');
  const navBtns = document.querySelectorAll('.nav-btn');
  const sections = document.querySelectorAll('.section');
  const quoteText = document.getElementById('quoteText');
  const newQuoteBtn = document.getElementById('newQuoteBtn');

  // 默认显示首页
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  const homeSec = document.getElementById('home'); if (homeSec) homeSec.classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.toggle('active', b.dataset.section === 'home'));

  // 语言
  function setActiveLang(lang) {
    languageOptions.forEach(o => o.classList.toggle('active', o.dataset.lang===lang));
    const flagSpan = languageBtn?.querySelector('.flag');
    const langSpan = languageBtn?.querySelector('[data-translate="currentLang"]');
    if (flagSpan && langSpan) {
      const map = { 'zh-CN':'cn', 'zh-TW':'tw', en:'en', ko:'kr', ja:'jp' };
      flagSpan.className = `flag flag-${map[lang]||'cn'}`;
      langSpan.textContent = translations[lang].currentLang;
    }
  }
  function updateContentLang() {
    document.querySelectorAll('[data-translate]').forEach(el => {
      const key = el.dataset.translate;
      const t = translations[currentLang]?.[key];
      if (t) el.textContent = t;
    });
    
    // 处理占位符翻译
    document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
      const key = el.dataset.translatePlaceholder;
      const t = translations[currentLang]?.[key];
      if (t) el.placeholder = t;
    });
    
    // 重新渲染博客以更新语言
    renderBlog();
    
    // 更新语录互动功能的语言
    if (currentQuoteData.text) {
      renderComments();
    }
  }
  if (languageBtn) {
    languageBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      dropdown?.classList.toggle('show');
    });
    document.addEventListener('click', () => dropdown?.classList.remove('show'));
  }
  languageOptions.forEach((opt) => {
    opt.addEventListener('click', () => {
      const lang = opt.dataset.lang;
      if (!translations[lang]) return;
      currentLang = lang;
      localStorage.setItem('lang', lang);
      updateContentLang();
      setActiveLang(lang);
      dropdown?.classList.remove('show');
    });
  });

  // 导航
  function goToSection(id) {
    const target = document.getElementById(id);
    if (!target) return;
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.toggle('active', b.dataset.section === id));
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    target.classList.add('active');
  }
  navBtns.forEach(btn=>{
    btn.addEventListener('click',()=>{
      const id = btn.dataset.section;
      goToSection(id);
    });
  });
  document.querySelectorAll('.cta-btn,[data-go]').forEach(el=>{
    el.addEventListener('click', (e)=>{
      e.preventDefault();
      const id = el.getAttribute('data-go');
      if (id) goToSection(id);
    });
  });

  // 语录
  function showRandomQuote(fade=true) {
    const list = quotes[currentLang] || quotes['zh-CN'];
    const q = list[Math.floor(Math.random()*list.length)];
    if (!quoteText) return;
    
    // 更新当前语录数据
    currentQuoteData.text = q;
    currentQuoteData.likes = 0;
    currentQuoteData.isLiked = false;
    currentQuoteData.isFavorited = false;
    currentQuoteData.comments = [];
    
    // 检查是否在收藏历史中
    const savedQuote = quoteHistory.find(item => item.text === q);
    if (savedQuote) {
      currentQuoteData.likes = savedQuote.likes || 0;
      currentQuoteData.isLiked = savedQuote.isLiked || false;
      currentQuoteData.isFavorited = savedQuote.isFavorited || false;
      currentQuoteData.comments = savedQuote.comments || [];
    }
    
    // 更新UI
    updateQuoteUI();
    
    if (fade) {
      quoteText.style.opacity='0';
      setTimeout(()=>{ 
        quoteText.textContent=q; 
        quoteText.style.opacity='1'; 
      },250);
    } else {
      quoteText.textContent=q;
    }
  }
  async function tryFetchQuote() {
    const endpoints = {
      'zh-CN': 'https://v1.hitokoto.cn/?encode=json',
      en: 'https://api.quotable.io/random'
    };
    const url = endpoints[currentLang] || endpoints['en'];
    try {
      const r = await fetch(url,{cache:'no-store'});
      const j = await r.json();
      const text = j?.hitokoto || j?.content;
      if (text && quoteText) {
        quoteText.style.opacity='0';
        setTimeout(()=>{ quoteText.textContent=text; quoteText.style.opacity='1'; },250);
      }
    } catch(e) {}
  }
  if (newQuoteBtn) newQuoteBtn.addEventListener('click', ()=>{ showRandomQuote(true); });
  

  

  
  function startQuoteAutoRotate() {
    if (quoteTimer) clearInterval(quoteTimer);
    // 移除自动轮换语录功能，只保留API获取功能
    quoteTimer = setInterval(()=>{ 
      if (document.getElementById('quote')?.classList.contains('active')) {
        // 只获取API语录，不自动更换本地语录
        // tryFetchQuote();
        // 移除随机更换语录的逻辑
      }
    }, 20000);
  }

  // Mystic: Tarot
  const tarotBtn = document.getElementById('tarotBtn');
  const tarotResult = document.getElementById('tarotResult');
  const tarotCards = [
    { name:'愚者 The Fool', upright:'新的开始、自由与信任直觉', reversed:'冲动、天真或缺乏计划', advice:'保持开放，但为未知留出缓冲与边界。' },
    { name:'魔术师 The Magician', upright:'意志与创造力的实现', reversed:'能量分散、表里不一', advice:'聚焦一个目标，资源就会形成合力。' },
    { name:'女祭司 The High Priestess', upright:'内在智慧、潜意识讯息', reversed:'直觉受阻、信息不透明', advice:'先安静，再行动；答案已在你心中。' },
    { name:'皇后 The Empress', upright:'丰饶、滋养、审美与享受', reversed:'过度纵容、失衡', advice:'善待自己，但别让舒适吞噬成长。' },
    { name:'命运之轮 Wheel of Fortune', upright:'转机、周期变化', reversed:'停滞、抗拒变化', advice:'顺势而为，改变是最稳的常量。' },
    { name:'太阳 The Sun', upright:'喜悦、清晰、自信', reversed:'短期低潮、暂时迷雾', advice:'回到热爱上，能量自然回来。' }
  ];
  if (tarotBtn) {
    tarotBtn.addEventListener('click', ()=>{
      const card = tarotCards[Math.floor(Math.random()*tarotCards.length)];
      const upright = Math.random()<0.5;
      tarotResult.style.display='block';
      tarotResult.style.opacity='0';
      setTimeout(()=>{
        tarotResult.innerHTML =
          `<div><strong>${card.name}${upright?'（正位）':'（逆位）'}</strong></div>
           <div style="margin-top:6px;">含义：${upright?card.upright:card.reversed}</div>
           <div style="margin-top:6px;">建议：${card.advice}</div>
           <button class="mystic-btn" id="tarotMore" style="margin-top:8px;">再抽一张</button>`;
        tarotResult.style.opacity='1';
        document.getElementById('tarotMore').onclick = () => tarotBtn.click();
      },220);
    });
  }

  // Mystic: Fortune cookie with history
  const fortuneBtn = document.getElementById('fortuneBtn');
  const fortuneResult = document.getElementById('fortuneResult');
  const fortuneHistory = document.getElementById('fortuneHistory');
  const fortunes = [
    '今天会有好运降临','保持微笑，好事即将发生','你的努力终将得到回报',
    '相信自己，你比想象中更强大','每一个挑战都是成长的机会','保持耐心，最好的还在后面'
  ];
  const fortuneList = [];
  if (fortuneBtn) {
    fortuneBtn.addEventListener('click', ()=>{
      const msg = fortunes[Math.floor(Math.random()*fortunes.length)];
      fortuneResult.style.display='block';
      fortuneResult.style.opacity='0';
      setTimeout(()=>{
        fortuneResult.innerHTML = `🍪 ${msg} <div style="margin-top:6px;"><button class="mystic-btn" id="fortuneAnother">再来一个</button></div>`;
        fortuneResult.style.opacity='1';
        fortuneList.unshift({time:new Date().toLocaleString(), msg});
        renderFortuneHistory();
        document.getElementById('fortuneAnother').onclick = ()=> fortuneBtn.click();
      },220);
    });
  }
  function renderFortuneHistory(){
    if (!fortuneHistory) return;
    fortuneHistory.style.display = 'block';
    fortuneHistory.innerHTML = '<div style="font-weight:600;margin-bottom:6px;">历史记录</div>' +
      fortuneList.slice(0,5).map(i=>`<div style="opacity:.9;">${i.time} - ${i.msg}</div>`).join('');
  }

  // Mystic: Astrology
  const astrologyBtn = document.getElementById('astrologyBtn');
  const zodiacSelect = document.getElementById('zodiacSelect');
  const astrologyResult = document.getElementById('astrologyResult');
  const astroData = {
    aries:{ mood:'行动力上升', luckyColor:'红色', luckyNumber: '1', tip:'大胆开局，小步快跑。' },
    taurus:{ mood:'稳重务实', luckyColor:'绿色', luckyNumber:'6', tip:'耐心是你今天的超能力。' },
    gemini:{ mood:'沟通顺畅', luckyColor:'黄色', luckyNumber:'3', tip:'把想法说出来，会有人响应。' },
    cancer:{ mood:'温柔治愈', luckyColor:'银色', luckyNumber:'2', tip:'照顾好自己，才能照顾他人。' },
    leo:{ mood:'自信高涨', luckyColor:'金色', luckyNumber:'5', tip:'适合站到台前，表达自己。' },
    virgo:{ mood:'条理清晰', luckyColor:'米色', luckyNumber:'7', tip:'把清单做小，就能持续推进。' },
    libra:{ mood:'关系顺滑', luckyColor:'粉色', luckyNumber:'9', tip:'多倾听，关系就会更柔软。' },
    scorpio:{ mood:'洞察敏锐', luckyColor:'紫色', luckyNumber:'8', tip:'直觉可靠，但别忽略事实。' },
    sagittarius:{ mood:'冒险精神', luckyColor:'蓝色', luckyNumber:'4', tip:'尝试新鲜事，收获在路上。' },
    capricorn:{ mood:'稳步精进', luckyColor:'棕色', luckyNumber:'8', tip:'今日适合打磨细节。' },
    aquarius:{ mood:'灵感喷涌', luckyColor:'青色', luckyNumber:'7', tip:'记录灵光，别让它们溜走。' },
    pisces:{ mood:'艺术气息', luckyColor:'白色', luckyNumber:'2', tip:'把感受写下来，会更轻松。' }
  };
  if (astrologyBtn) {
    astrologyBtn.addEventListener('click',()=>{
      const sign = zodiacSelect.value || 'aries';
      const d = astroData[sign];
      astrologyResult.style.display='block';
      astrologyResult.style.opacity='0';
      setTimeout(()=>{
        astrologyResult.innerHTML = `心情：${d.mood}<br>幸运色：${d.luckyColor}，幸运数字：${d.luckyNumber}<br>建议：${d.tip}`;
        astrologyResult.style.opacity='1';
      },220);
    });
  }

  // 泡泡
  function initBubbleGame(){
    const box = document.querySelector('.bubble-game');
    if (!box) return;
    setInterval(()=>{
      const size = Math.random()*44 + 18;
      const b = document.createElement('div');
      b.className='bubble';
      b.style.width=b.style.height=size+'px';
      b.style.left = Math.random()*(box.clientWidth - size) + 'px';
      b.style.top = box.clientHeight + 'px';
      b.addEventListener('click',()=>{ b.remove(); bubbleScore++; (document.getElementById('bubbleScore')||{}).textContent=bubbleScore; });
      box.appendChild(b);
      let y = box.clientHeight;
      const mover = setInterval(()=>{
        y -= 2; b.style.top = y + 'px';
        if (y < -size) { clearInterval(mover); b.remove(); }
      }, 30);
    }, 900);
  }

  // 沙画（尺寸+DPR+触摸）
  function initSandCanvas(){
    const c = document.querySelector('.sand-canvas');
    if (!c) return;
    const ctx = c.getContext('2d');
    function resize(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const cssW = c.clientWidth, cssH = c.clientHeight;
      c.width = Math.floor(cssW * dpr);
      c.height = Math.floor(cssH * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      ctx.fillStyle = '#fef5e7';
      ctx.fillRect(0,0,cssW,cssH);
    }
    resize();
    window.addEventListener('resize', resize);

    let drawing = false;
    function pos(e){
      if (e.touches && e.touches[0]) return { x: e.touches[0].clientX - c.getBoundingClientRect().left, y: e.touches[0].clientY - c.getBoundingClientRect().top };
      return { x: e.clientX - c.getBoundingClientRect().left, y: e.clientY - c.getBoundingClientRect().top };
    }
    function start(e){ drawing=true; draw(e); }
    function draw(e){
      if (!drawing) return;
      const p = pos(e);
      ctx.fillStyle = '#667eea';
      ctx.beginPath(); ctx.arc(p.x, p.y, 3.2, 0, Math.PI*2); ctx.fill();
      e.preventDefault();
    }
    function end(){ drawing=false; }

    c.addEventListener('mousedown', start);
    c.addEventListener('mousemove', draw);
    c.addEventListener('mouseup', end);
    c.addEventListener('mouseleave', end);
    c.addEventListener('touchstart', start, {passive:false});
    c.addEventListener('touchmove', draw, {passive:false});
    c.addEventListener('touchend', end);
  }

  // 心理测试
  const moodBtn = document.querySelector('.mood-check-btn');
  if (moodBtn) {
    moodBtn.addEventListener('click', ()=>{
      const selected = document.querySelector('input[name="mood"]:checked');
      const box = document.querySelector('.mood-result');
      if (!selected) { 
        const alertMsg = currentLang === 'zh-CN' ? '请选择一个选项！' : 
                        currentLang === 'zh-TW' ? '請選擇一個選項！' :
                        currentLang === 'en' ? 'Please select an option!' :
                        currentLang === 'ko' ? '옵션을 선택해주세요!' :
                        currentLang === 'ja' ? 'オプションを選択してください！' : '请选择一个选项！';
        alert(alertMsg); 
        return; 
      }
      const responses = {
        'zh-CN':{ happy:'太好了！保持积极，你正在发光✨', calm:'珍惜这份宁静🌸', anxious:'试试深呼吸，一切会好起来🌈', sad:'允许自己难过，这也是治愈💙', tired:'给自己一些时间恢复能量🌙' },
        'zh-TW':{ happy:'太好了！保持積極，你正在發光✨', calm:'珍惜這份寧靜🌸', anxious:'試試深呼吸，一切會好起來🌈', sad:'允許自己難過，這也是治癒💙', tired:'給自己一些時間恢復能量🌙' },
        en:{ happy:'Wonderful! Keep the positive vibe✨', calm:'Cherish the calm🌸', anxious:'Try deep breathing🌈', sad:"It's okay to feel sad💙", tired:'Rest to go further🌙' },
        ko:{ happy:'훌륭해요! 긍정적인 기운을 유지하세요, 당신은 빛나고 있어요✨', calm:'이 평온함을 소중히 하세요🌸', anxious:'깊은 호흡을 시도해보세요, 모든 것이 좋아질 거예요🌈', sad:'슬픔을 느껴도 괜찮아요, 이것도 치유예요💙', tired:'에너지를 회복할 시간을 주세요🌙' },
        ja:{ happy:'素晴らしい！ポジティブを保って、あなたは輝いています✨', calm:'この静寂を大切に🌸', anxious:'深呼吸を試してみて、すべて良くなります🌈', sad:'悲しみを感じても大丈夫、これも癒しです💙', tired:'エネルギーを回復する時間をあげてください🌙' }
      };
      const text = (responses[currentLang]||responses['zh-CN'])[selected.value];
      box.style.display='block'; box.style.opacity='0';
      setTimeout(()=>{ box.textContent=text; box.style.opacity='1'; },220);
    });
  }

  // 日记
  const journalTextarea = document.querySelector('.journal-textarea');
  const [saveJournalBtn, viewJournalBtn, clearJournalBtn] = document.querySelectorAll('.journal-btn');
  const journalEntriesDiv = document.querySelector('.journal-entries');
  let journalEntries = JSON.parse(localStorage.getItem('journalEntries')||'[]');
  function renderJournal(){
    if (!journalEntriesDiv) return;
    const noEntriesMsg = currentLang === 'zh-CN' ? '还没有日记记录' : 
                         currentLang === 'zh-TW' ? '還沒有日記記錄' :
                         currentLang === 'en' ? 'No journal entries yet' :
                         currentLang === 'ko' ? '아직 일기 기록이 없습니다' :
                         currentLang === 'ja' ? 'まだ日記の記録がありません' : '还没有日记记录';
    journalEntriesDiv.innerHTML = journalEntries.length? '' : `<p>${noEntriesMsg}</p>`;
    journalEntries.forEach(e=>{
      const d = document.createElement('div'); d.className='journal-entry';
      d.innerHTML = `<div class="entry-date">${e.date}</div><div class="entry-text">${e.text}</div>`;
      journalEntriesDiv.appendChild(d);
    });
  }
  if (saveJournalBtn) saveJournalBtn.addEventListener('click', ()=>{
    if (!journalTextarea.value.trim()) { 
      const alertMsg = currentLang === 'zh-CN' ? '请写点什么再保存！' : 
                      currentLang === 'zh-TW' ? '請寫點什麼再保存！' :
                      currentLang === 'en' ? 'Please write something before saving!' :
                      currentLang === 'ko' ? '저장하기 전에 뭔가를 써주세요!' :
                      currentLang === 'ja' ? '保存する前に何かを書いてください！' : '请写点什么再保存！';
      alert(alertMsg); 
      return; 
    }
    journalEntries.unshift({ date:new Date().toLocaleDateString(), text:journalTextarea.value.trim() });
    localStorage.setItem('journalEntries', JSON.stringify(journalEntries));
    journalTextarea.value=''; 
    const successMsg = currentLang === 'zh-CN' ? '日记保存成功！' : 
                      currentLang === 'zh-TW' ? '日記保存成功！' :
                      currentLang === 'en' ? 'Journal saved!' :
                      currentLang === 'ko' ? '일기가 저장되었습니다!' :
                      currentLang === 'ja' ? '日記が保存されました！' : '日记保存成功！';
    alert(successMsg);
  });
  if (viewJournalBtn) viewJournalBtn.addEventListener('click', ()=>{
    if (journalEntriesDiv.style.display!=='block') { 
      renderJournal(); 
      journalEntriesDiv.style.display='block'; 
      const hideText = currentLang === 'zh-CN' ? '隐藏记录' : 
                      currentLang === 'zh-TW' ? '隱藏記錄' :
                      currentLang === 'en' ? 'Hide Entries' :
                      currentLang === 'ko' ? '기록 숨기기' :
                      currentLang === 'ja' ? '記録を隠す' : '隐藏记录';
      viewJournalBtn.textContent = hideText; 
    }
    else { 
      journalEntriesDiv.style.display='none'; 
      viewJournalBtn.textContent = translations[currentLang].viewJournal; 
    }
  });
  if (clearJournalBtn) clearJournalBtn.addEventListener('click', ()=>{
    const confirmMsg = currentLang === 'zh-CN' ? '确定要清空所有日记吗？' : 
                      currentLang === 'zh-TW' ? '確定要清空所有日記嗎？' :
                      currentLang === 'en' ? 'Clear all journal entries?' :
                      currentLang === 'ko' ? '모든 일기를 지우시겠습니까?' :
                      currentLang === 'ja' ? 'すべての日記を消去しますか？' : '确定要清空所有日记吗？';
    if (confirm(confirmMsg)) {
      journalEntries=[]; localStorage.setItem('journalEntries','[]'); journalEntriesDiv.innerHTML=''; journalEntriesDiv.style.display='none';
      viewJournalBtn.textContent = translations[currentLang].viewJournal;
    }
  });

  // 自然音
  const audioMap = new Map();
  const soundFiles = {
    rain:'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQo=',
    ocean:'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQo=',
    forest:'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQo='
  };
  document.querySelectorAll('.sound-toggle').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const k = btn.dataset.sound;
      let a = audioMap.get(k);
      if (btn.classList.contains('playing')) {
        if (a) { a.pause(); a.currentTime=0; }
        btn.classList.remove('playing'); btn.textContent = translations[currentLang].playSound;
      } else {
        if (!a) { a = new Audio(soundFiles[k]); a.loop=true; audioMap.set(k,a); }
        a.play().catch(()=>{
          const errorMsg = currentLang === 'zh-CN' ? '音频播放失败，请检查浏览器设置' : 
                          currentLang === 'zh-TW' ? '音頻播放失敗，請檢查瀏覽器設置' :
                          currentLang === 'en' ? 'Audio play failed, please check browser settings' :
                          currentLang === 'ko' ? '오디오 재생 실패, 브라우저 설정을 확인해주세요' :
                          currentLang === 'ja' ? 'オーディオ再生に失敗しました、ブラウザの設定を確認してください' : '音频播放失败，请检查浏览器设置';
          alert(errorMsg);
        });
        btn.classList.add('playing'); 
        const stopText = currentLang === 'zh-CN' ? '停止' : 
                        currentLang === 'zh-TW' ? '停止' :
                        currentLang === 'en' ? 'Stop' :
                        currentLang === 'ko' ? '정지' :
                        currentLang === 'ja' ? '停止' : '停止';
        btn.textContent = stopText;
      }
    });
  });
  document.querySelectorAll('.volume-slider').forEach(sl=>{
    sl.addEventListener('input', ()=>{
      const k = sl.dataset.sound; const a = audioMap.get(k); if (a) a.volume = sl.value/100;
    });
  });

  // 呼吸文案循环
  function updateBreathingText(){
    const texts = breathingTexts[currentLang] || breathingTexts['zh-CN'];
    if (breathingTextEl) breathingTextEl.textContent = texts[breathingPhase];
    const delay = breathingDurations[breathingPhase];
    breathingPhase = (breathingPhase + 1) % 4;
    setTimeout(updateBreathingText, delay);
  }

  // 博客渲染
  function renderBlog(){
    const listEl = document.getElementById('blogList');
    if (!listEl) return;
    listEl.innerHTML = '';
    
    // 获取当前语言的博客数据
    const posts = blogPosts[currentLang] || blogPosts['zh-CN'];
    
    posts.forEach((p,idx)=>{
      const card = document.createElement('div'); card.className='post-card';
      
      // 根据语言设置按钮文案
      const expandText = currentLang === 'zh-CN' ? '展开/收起' : 
                        currentLang === 'zh-TW' ? '展開/收起' :
                        currentLang === 'en' ? 'Expand/Collapse' :
                        currentLang === 'ko' ? '펼치기/접기' :
                        currentLang === 'ja' ? '展開/折りたたみ' : '展开/收起';
      
      card.innerHTML =
        `<div class="post-title">${p.title}</div>
         <div class="post-meta">${p.date}</div>
         <div>${p.summary}</div>
         <div class="post-tags">${(p.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
         <div class="post-actions">
           <button class="btn-link" data-id="${idx}">${expandText}</button>
         </div>
         <div class="post-content" id="post-${idx}">${p.content}</div>`;
      listEl.appendChild(card);
    });
    
    listEl.querySelectorAll('.btn-link').forEach(b=>{
      b.addEventListener('click',()=>{
        const id = b.dataset.id; const c = document.getElementById('post-'+id);
        c.style.display = c.style.display==='block' ? 'none' : 'block';
      });
    });
  }

  // 初始化
  function init(){
    updateContentLang(); setActiveLang(currentLang);
    showRandomQuote(false); startQuoteAutoRotate();
    initBubbleGame(); initSandCanvas(); renderBlog();
    updateBreathingText();
    
    // 初始化语录互动功能
    initQuoteInteractions();
  }
  
  // 初始化语录互动功能
  function initQuoteInteractions() {
    console.log('开始初始化语录互动功能');
    
    // 为评论输入框添加回车键提交功能
    setTimeout(() => {
      const commentText = document.getElementById('commentText');
      if (commentText) {
        commentText.addEventListener('keypress', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            addComment();
          }
        });
        console.log('评论输入框回车键事件绑定成功');
      }
    }, 500);
    
    // 初始化UI状态
    updateQuoteUI();
    
    console.log('语录互动功能初始化完成（使用内联事件处理器）');
  }
  
  init();
  

});
  </script>
</body>
</html> 